# splunkhomelab using virtualbox

This repository documents the deployment of a **Cybersecurity Home Lab** designed to simulate attacks and practice threat detection. Built on **VirtualBox** (Kali Linux & Windows 10), it leverages **Sysmon** for advanced telemetry and **Splunk Enterprise** for centralized log analysis

üõ†Ô∏è Phase 0: Lab Prerequisites
Before configuring the network, the following environments were deployed on VirtualBox.

**Attacker:** [Kali Linux 2024.x (VirtualBox Image)](https://www.kali.org/get-kali/#kali-virtual-machines)
**Victim:** [Windows 10 (Official ISO Tool)](https://www.microsoft.com/en-us/software-download/windows10)
**Hypervisor:** [Oracle VirtualBox 7.0](https://www.virtualbox.org/wiki/Downloads)


## üåê Phase 1: Network Architecture
To simulate a realistic corporate LAN isolated from my home Wi-Fi, I created a custom **NAT Network**. This ensures the Attacker and Victim can communicate directly while remaining protected behind a virtual gateway.
### ‚öôÔ∏è Configuration Steps
1.  Open VirtualBox **Network Manager** (`File` > `Tools` > `Network Manager`).
2.  Create a new NAT Network named `HackingLab`.
3.  **CIDR:** Set to `10.0.2.0/24` to define the subnet.
4.  **DHCP:** Enabled (to handle automatic IP assignment).

<img width="944" height="189" alt="v4ilkq5asL" src="https://github.com/user-attachments/assets/d755a8cb-031a-4678-ad0e-2412cdc96786" />



<img width="959" height="585" alt="cdW1vsMS8G" src="https://github.com/user-attachments/assets/7b2a4f61-a879-48f8-8a05-915ad613e001" />


## üëÅÔ∏è Phase 2: Endpoint Visibility (Sysmon)
Standard Windows logs are often insufficient for detecting advanced threats. To bridge this gap, I deployed **Sysmon** with a community-hardened configuration.

### üõ†Ô∏è Tools Used
* **Agent:** [Sysmon (Official Microsoft Download)](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon)
* **Configuration:** [SwiftOnSecurity XML Config](https://github.com/SwiftOnSecurity/sysmon-config) (Filters noise and maps MITRE ATT&CK events)

### Configuration Strategy
Instead of the default settings, I applied the SwiftOnSecurity configuration to focus on critical anomalies. 

### Deployment Log
I installed Sysmon as a service using PowerShell with admin privileges, enabling hash algorithms to track file integrity.


<img width="851" height="366" alt="j4QGpCHm2z" src="https://github.com/user-attachments/assets/4ba78549-63b5-48b4-b827-b07c303f0955" />



üß† Phase 3: SIEM Ingestion (Splunk Enterprise)

With telemetry generated by Sysmon, the next step was to centralize it.
üõ†Ô∏è Tools Used

    SIEM: Splunk Enterprise (Official Download)

    Why Splunk? It is the industry standard for analyzing machine data. It turns raw logs into searchable information, allowing us to correlate events and detect threats in real-time (impossible to do with just Event Viewer).

üöß Challenge: Manual Configuration

The standard GUI method ("Add Data") failed to detect the Microsoft-Windows-Sysmon/Operational channel automatically. Instead of relying on the wizard, I manually configured the input at the configuration file level.
üõ†Ô∏è Implementation Steps

    Service Privilege Escalation: I verified that the Splunkd service was running as a low-privilege account (NT SERVICE). I changed it to Local System via services.msc to ensure it had permissions to read the secured Sysmon logs.

    Config File Editing:

        I opened the configuration file C:\Program Files\Splunk\etc\system\local\inputs.conf using Notepad (as Administrator).

        I manually appended the stanza to force the ingestion of Sysmon logs:

Ini, TOML

[WinEventLog://Microsoft-Windows-Sysmon/Operational]
disabled = 0
renderXml = 1
checkpointInterval = 5
current_only = 0
start_from = oldest
index = main

    Restart: Restarted the Splunk service to load the new configuration.

‚úÖ Verification (PoC)

To validate the pipeline, I executed a basic SPL query.

SPL Query:
Fragmento de c√≥digo

index=main sourcetype="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational.


